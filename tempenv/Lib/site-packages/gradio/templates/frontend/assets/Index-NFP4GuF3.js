import"./svelte/svelte_internal_flags_async.js";import*as e from"./svelte/svelte_internal_client.js";import"./i18n-BSEU4Bba.js";import{f as vt,s as ht,G as bt}from"./utils.svelte-kG009vb9.js";import"./svelte/svelte_internal_flags_legacy.js";import{tick as N,onMount as he,onDestroy as xt,createEventDispatcher as wt,beforeUpdate as yt,afterUpdate as kt}from"./svelte/svelte_svelte.js";import{l as Ge,g as qt,r as Ct,o as Ue,z as Be,A as At,j as zt,G as Rt,H as Dt,s as St,F as Mt,B as Et}from"./ScrollFade-Df4eOX7N.js";import{U as It}from"./ModifyUpload-BBImu3IT.js";import{I as Tt}from"./Image-Bdf4wQSw.js";import"./ImagePreview-BoIZsleR.js";import{o as We}from"./Index-BIhK41kE.js";import{u as Pt,p as Ft,M as Ht}from"./StaticAudio-CrG63HUl.js";import"./Example-COthpgua.js";import{p as Ut}from"./index-Iu0hi-Ff.js";import{S as Bt}from"./StreamingBar-Ck4VV0Q5.js";import{default as Vr}from"./Example-Cfx_Qdy1.js";import"./svelte/svelte_store.js";import"./MarkdownCode-B3eIh5Gl.js";import"./prism-python-BCCznRiZ.js";import"./ShareButton-c50NWbgM.js";import"./FullscreenButton-D5DJ9370.js";import"./VolumeLevels-BcPajCFg.js";import"./svelte/svelte_animate.js";import"./svelte/svelte_attachments.js";import"./svelte/svelte_easing.js";import"./svelte/svelte_internal_flags_tracing.js";import"./svelte/svelte_internal_server.js";import"./svelte/svelte_legacy.js";import"./svelte/svelte_motion.js";import"./svelte/svelte_reactivity.js";import"./svelte/svelte_reactivity_window.js";import"./svelte/svelte_server.js";import"./svelte/svelte_transition.js";import"./svelte/svelte_events.js";import"./Video-BrnW2L40.js";async function ie(w,l,i){if(await N(),l===i)return;const v=window.getComputedStyle(w),F=parseFloat(v.paddingTop),r=parseFloat(v.paddingBottom),T=parseFloat(v.lineHeight);let u=i===void 0?!1:F+r+T*i,f=F+r+l*T;w.style.height="1px";let q;u&&w.scrollHeight>u?q=u:w.scrollHeight<f?q=f:q=w.scrollHeight,w.style.height=`${q}px`}function Wt(w,l){if(l.lines===l.max_lines)return;w.style.overflowY="scroll";function i(v){ie(v.target,l.lines,l.max_lines)}if(w.addEventListener("input",i),!!l.text.trim())return ie(w,l.lines,l.max_lines),{destroy:()=>w.removeEventListener("input",i)}}e.from_html("<audio></audio>");var Gt=e.from_html("<option> </option>"),jt=e.from_html('<select class="device-select-large svelte-doy9oc" aria-label="Select input device"></select>'),Lt=e.from_html('<div class="device-selection-wrapper svelte-doy9oc"><!> <button class="record-button svelte-doy9oc" aria-label="Start recording"></button></div>'),Vt=e.from_html('<div class="waveform-wrapper svelte-doy9oc"></div> <div class="timestamp svelte-doy9oc"> </div> <button class="stop-button svelte-doy9oc" aria-label="Stop recording"><!></button>',1),Kt=e.from_html('<div class="minimal-audio-recorder svelte-doy9oc" data-testid="minimal-audio-recorder"><!></div>');function Yt(w,l){e.push(l,!0);let i=e.prop(l,"waveform_settings",19,()=>({})),v=e.prop(l,"recording",15),F=e.prop(l,"max_file_size",3,null),r=e.prop(l,"upload_promise",15),T,u,f,q=0,h,H=!1,j=!1,A=[],z="",P=!1;const L=()=>{clearInterval(h),h=setInterval(()=>{q++},1e3)},V=async()=>{if(!T)return;u&&u.destroy();const m=getComputedStyle(document.documentElement).getPropertyValue("--color-accent")||"#ff7c00";u=Pt.create({container:T,height:32,waveColor:"rgba(128, 128, 128, 0.5)",progressColor:m,cursorColor:"transparent",barWidth:2,barGap:2,barRadius:2,interact:!1,hideScrollbar:!0,...i()}),f=u.registerPlugin(We.create({scrollingWaveform:!0,scrollingWaveformWindow:7,renderRecordedAudio:!1})),f.on("record-start",()=>{L(),H=!0,j=!0}),f.on("record-end",async y=>{clearInterval(h),H=!1,r((async()=>{try{const D=await y.arrayBuffer(),B=await new AudioContext({sampleRate:i().sampleRate||44100}).decodeAudioData(D);if(B){const S=await Ft(B),n=new File([S],"audio.wav",{type:"audio/wav"}),E=await Ut([n],!1),d=(await l.upload(E,l.root,void 0,F()||void 0))?.[0];d&&l.onchange?.(d)}}catch(D){console.error("Error processing audio:",D)}finally{l.onstoprecording?.(),r(null)}})()),await r()})};he(async()=>{try{A=(await We.getAvailableAudioDevices()).filter(y=>y.deviceId),A.length>0&&(z=A[0].deviceId),A.length>1?P=!0:await V()}catch{await V()}}),xt(()=>{clearInterval(h),f&&f.stopMic(),u&&u.destroy()}),e.user_effect(()=>{v()&&!H&&f&&j===!1&&A.length<=1?f.startMic({deviceId:z}).then(()=>{f?.startRecording()}):!v()&&H&&f&&(f.stopRecording(),q=0)});async function R(){if(P=!1,j=!0,await N(),await V(),!!f)try{await f.startMic({deviceId:z}),f.startRecording()}catch(m){console.error("Error starting recording:",m),P=A.length>1,j=!1,v(!1)}}var U=Kt(),O=e.child(U);{var re=m=>{var y=Lt(),D=e.child(y);{var b=S=>{var n=jt();e.each(n,21,()=>A,e.index,(E,k)=>{var d=Gt(),Q=e.child(d,!0);e.reset(d);var G={};e.template_effect(()=>{e.set_text(Q,e.get(k).label),G!==(G=e.get(k).deviceId)&&(d.value=(d.__value=e.get(k).deviceId)??"")}),e.append(E,d)}),e.reset(n),e.bind_select_value(n,()=>z,E=>z=E),e.append(S,n)};e.if(D,S=>{A.length>1&&S(b)})}var B=e.sibling(D,2);B.__click=R,e.reset(y),e.append(m,y)},K=m=>{var y=Vt(),D=e.first_child(y);e.bind_this(D,E=>T=E,()=>T);var b=e.sibling(D,2),B=e.child(b,!0);e.reset(b);var S=e.sibling(b,2);S.__click=()=>{v(!1)};var n=e.child(S);Ge(n,{}),e.reset(S),e.template_effect(E=>e.set_text(B,E),[()=>vt(q)]),e.append(m,y)};e.if(O,m=>{P?m(re):m(K,!1)})}e.reset(U),e.template_effect(()=>e.set_attribute(U,"aria-label",l.label||"Audio Recorder")),e.append(w,U),e.pop()}e.delegate(["click"]);var Xt=e.from_html('<div class="recording-content svelte-1qn0337"><!></div>'),Jt=e.from_html('<div class="recording-content svelte-1qn0337"><!> <div class="action-buttons svelte-1qn0337"><button class="confirm-button svelte-1qn0337" aria-label="Attach audio"><!></button> <button class="cancel-button svelte-1qn0337" aria-label="Clear audio"><!></button></div></div>'),Nt=e.from_html("<div><!></div>"),Ot=e.from_html('<button data-testid="upload-button" class="upload-button thumbnail-add svelte-1qn0337" aria-label="Upload a file"><!></button>'),Qt=e.from_html('<span class="thumbnail-wrapper svelte-1qn0337" role="listitem" aria-label="File thumbnail"><div class="thumbnail-item thumbnail-small svelte-1qn0337"><!> <button class="delete-button svelte-1qn0337" aria-label="Remove file"><!></button></div></span>'),Zt=e.from_html('<div class="loader svelte-1qn0337" role="status" aria-label="Uploading"></div>'),$t=e.from_html('<div class="thumbnails svelte-1qn0337" aria-label="Uploaded files" data-testid="container_el"><!> <!> <!></div>'),er=e.from_html('<button data-testid="upload-button" class="upload-button icon-button svelte-1qn0337" aria-label="Upload a file"><!></button>'),tr=e.from_html('<button data-testid="microphone-button" aria-label="Record audio"><!></button>'),rr=e.from_html('<button data-testid="submit-button" aria-label="Submit"><!></button>'),ar=e.from_html('<button aria-label="Stop"><!></button>'),lr=e.from_html('<div role="group" aria-label="Multimedia input field"><!> <div class="input-container svelte-1qn0337"><!> <!> <div><!> <div class="input-row svelte-1qn0337"><!> <div class="textarea-wrapper svelte-1qn0337"><textarea data-testid="textbox"></textarea> <!></div> <!> <!> <!></div></div></div></div>');function sr(w,l){e.push(l,!1);const i=e.mutable_source(),v=e.mutable_source(),F=e.mutable_source();let r=e.prop(l,"value",28,()=>({text:"",files:[]})),T=e.prop(l,"value_is_output",12,!1),u=e.prop(l,"lines",12,1),f=e.prop(l,"i18n",12),q=e.prop(l,"placeholder",12,""),h=e.prop(l,"disabled",12,!1),H=e.prop(l,"label",12),j=e.prop(l,"info",12,void 0),A=e.prop(l,"show_label",12,!0),z=e.prop(l,"max_lines",12),P=e.prop(l,"submit_btn",12,null),L=e.prop(l,"stop_btn",12,null),V=e.prop(l,"rtl",12,!1),R=e.prop(l,"autofocus",12,!1),U=e.prop(l,"text_align",12,void 0),O=e.prop(l,"autoscroll",12,!0),re=e.prop(l,"root",12),K=e.prop(l,"file_types_string",12,null),m=e.prop(l,"max_file_size",12,null),y=e.prop(l,"upload",12),D=e.prop(l,"stream_handler",12),b=e.prop(l,"file_count",12,"multiple"),B=e.prop(l,"max_plain_text_length",12,1e3),S=e.prop(l,"waveform_settings",12),n=e.prop(l,"waveform_options",28,()=>({show_recording_waveform:!0})),E=e.prop(l,"sources_string",12,"upload"),k=e.prop(l,"active_source",12,null),d=e.prop(l,"html_attributes",12,null),Q=e.prop(l,"upload_promise",12,null),G=e.mutable_source(),x=e.mutable_source(),ne,be=0,de=!1,xe=e.mutable_source(!1),Y=e.prop(l,"dragging",12,!1),Z=e.mutable_source(!1),ue=e.mutable_source(r()?.text??""),$=e.mutable_source(!1),X=e.mutable_source(null),ce=e.mutable_source();function we(){e.set(xe,ht(e.get(x)))}const M=wt();yt(()=>{ne=e.get(x)&&e.get(x).offsetHeight+e.get(x).scrollTop>e.get(x).scrollHeight-100});const je=()=>{ne&&O()&&!de&&e.get(x).scrollTo(0,e.get(x).scrollHeight)};async function ye(){M("change",r()),T()||M("input")}he(()=>{R()&&e.get(x)!==null&&e.get(x).focus()}),kt(()=>{ne&&O()&&je(),R()&&e.get(x)&&e.get(x).focus()});function Le(t){const a=t.target,s=a.value,c=[a.selectionStart,a.selectionEnd];M("select",{value:s.substring(...c),index:c})}async function Ve(t){t.key==="Enter"&&t.shiftKey&&u()>1?(t.preventDefault(),await N(),M("submit")):t.key==="Enter"&&!t.shiftKey&&u()===1&&z()>=1&&(t.preventDefault(),_e(),k(null),await N(),M("submit"))}function Ke(t){const a=t.target,s=a.scrollTop;s<be&&(de=!0),be=s;const c=a.scrollHeight-a.clientHeight;s>=c&&(de=!1),we()}async function Ye(t){if(ye(),Array.isArray(t)){for(let a of t)r().files.push(a);r(r())}else r().files.push(t),r(r());await N(),M("change",r()),M("upload",t)}function Xe(t,a){ye(),t.stopPropagation(),r().files.splice(a,1),r(r())}function ke(){e.get(G).open_upload()}function Je(){M("stop")}function _e(){e.get(X)&&(r().files.push(e.get(X)),r(r()),e.set(X,null),M("change",r()))}function Ne(){_e(),k(null),M("submit")}async function Oe(t){if(!t.clipboardData)return;const a=t.clipboardData.items,s=t.clipboardData.getData("text");if(s&&s.length>B()){t.preventDefault();const c=new window.File([s],"pasted_text.txt",{type:"text/plain",lastModified:Date.now()});e.get(G)&&e.get(G).load_files([c]);return}for(let c in a){const C=a[c];if(C.kind==="file"&&C.type.includes("image")){const I=C.getAsFile();I&&e.get(G).load_files([I])}}}function Qe(t){t.preventDefault(),Y(!0)}function Ze(t){t.preventDefault();const a=e.get(ce).getBoundingClientRect(),{clientX:s,clientY:c}=t;(s<=a.left||s>=a.right||c<=a.top||c>=a.bottom)&&Y(!1)}function $e(t){if(t.preventDefault(),Y(!1),t.dataTransfer&&t.dataTransfer.files){const a=Array.from(t.dataTransfer.files);if(e.get(v)){const s=a.filter(C=>e.get(v).some(I=>I.startsWith(".")?C.name.toLowerCase().endsWith(I.toLowerCase()):C.type.match(new RegExp(I.replace("*",".*"))))),c=a.length-s.length;c>0&&M("error",`${c} file(s) were rejected. Accepted formats: ${e.get(v).join(", ")}`),s.length>0&&e.get(G).load_files(s)}else e.get(G).load_files(a)}}e.legacy_pre_effect(()=>e.deep_read_state(E()),()=>{e.set(i,E().split(",").map(t=>t.trim()).filter(t=>t==="upload"||t==="microphone"))}),e.legacy_pre_effect(()=>e.deep_read_state(K()),()=>{e.set(v,K()?K().split(",").map(t=>t.trim()):null)}),e.legacy_pre_effect(()=>e.deep_read_state(Y()),()=>{M("drag",Y())}),e.legacy_pre_effect(()=>e.deep_read_state(r()),()=>{r()===null&&r({text:"",files:[]})}),e.legacy_pre_effect(()=>(e.get(i),e.deep_read_state(b()),e.deep_read_state(r())),()=>{e.set(F,e.get(i)&&e.get(i).includes("upload")&&!(b()==="single"&&r().files.length>0))}),e.legacy_pre_effect(()=>(e.get(ue),e.deep_read_state(r())),()=>{e.get(ue)!==r().text&&(M("change",r()),e.set(ue,r().text))}),e.legacy_pre_effect(()=>(e.deep_read_state(r()),e.get(x),e.deep_read_state(u()),e.deep_read_state(z()),ie),()=>{r(),e.get(x)&&u()!==z()&&ie(e.get(x),u(),z())}),e.legacy_pre_effect(()=>(e.get(x),e.deep_read_state(r()),N),()=>{e.get(x)&&r().text!==void 0&&N().then(we)}),e.legacy_pre_effect_reset();var et={get value(){return r()},set value(t){r(t),e.flush()},get value_is_output(){return T()},set value_is_output(t){T(t),e.flush()},get lines(){return u()},set lines(t){u(t),e.flush()},get i18n(){return f()},set i18n(t){f(t),e.flush()},get placeholder(){return q()},set placeholder(t){q(t),e.flush()},get disabled(){return h()},set disabled(t){h(t),e.flush()},get label(){return H()},set label(t){H(t),e.flush()},get info(){return j()},set info(t){j(t),e.flush()},get show_label(){return A()},set show_label(t){A(t),e.flush()},get max_lines(){return z()},set max_lines(t){z(t),e.flush()},get submit_btn(){return P()},set submit_btn(t){P(t),e.flush()},get stop_btn(){return L()},set stop_btn(t){L(t),e.flush()},get rtl(){return V()},set rtl(t){V(t),e.flush()},get autofocus(){return R()},set autofocus(t){R(t),e.flush()},get text_align(){return U()},set text_align(t){U(t),e.flush()},get autoscroll(){return O()},set autoscroll(t){O(t),e.flush()},get root(){return re()},set root(t){re(t),e.flush()},get file_types_string(){return K()},set file_types_string(t){K(t),e.flush()},get max_file_size(){return m()},set max_file_size(t){m(t),e.flush()},get upload(){return y()},set upload(t){y(t),e.flush()},get stream_handler(){return D()},set stream_handler(t){D(t),e.flush()},get file_count(){return b()},set file_count(t){b(t),e.flush()},get max_plain_text_length(){return B()},set max_plain_text_length(t){B(t),e.flush()},get waveform_settings(){return S()},set waveform_settings(t){S(t),e.flush()},get waveform_options(){return n()},set waveform_options(t){n(t),e.flush()},get sources_string(){return E()},set sources_string(t){E(t),e.flush()},get active_source(){return k()},set active_source(t){k(t),e.flush()},get html_attributes(){return d()},set html_attributes(t){d(t),e.flush()},get upload_promise(){return Q()},set upload_promise(t){Q(t),e.flush()},get dragging(){return Y()},set dragging(t){Y(t),e.flush()}};e.init();var J=lr();let qe;var Ce=e.child(J);qt(Ce,{get show_label(){return A()},get info(){return j()},get rtl(){return V()},children:(t,a)=>{e.next();var s=e.text();e.template_effect(()=>e.set_text(s,H())),e.append(t,s)},$$slots:{default:!0}});var Ae=e.sibling(Ce,2),ze=e.child(Ae);{var tt=t=>{var a=Nt();let s;var c=e.child(a);{var C=g=>{var p=Xt(),_=e.child(p);{let ee=e.derived_safe_equal(()=>H()||"Audio");Yt(_,{get label(){return e.get(ee)},get waveform_settings(){return S()},get recording(){return e.get($)},get upload(){return y()},get root(){return re()},get max_file_size(){return m()},onchange:W=>{e.set(X,W)},onstoprecording:()=>{e.set($,!1),M("stop_recording")},onclear:()=>{k(null),e.set($,!1),e.set(X,null)},get upload_promise(){return Q()},set upload_promise(W){Q(W)},$$legacy:!0})}e.reset(p),e.append(g,p)},I=g=>{var p=Jt(),_=e.child(p);{let me=e.derived_safe_equal(()=>H()||"Audio");Ht(_,{get value(){return e.get(X)},get label(){return e.get(me)},loop:!1})}var ee=e.sibling(_,2),W=e.child(ee),oe=e.child(W);zt(oe),e.reset(W);var ae=e.sibling(W,2),ge=e.child(ae);Ue(ge),e.reset(ae),e.reset(ee),e.reset(p),e.event("click",W,()=>{_e(),k(null),e.set($,!1)}),e.event("click",ae,()=>{k(null),e.set($,!1),e.set(X,null)}),e.append(g,p)};e.if(c,g=>{e.get(X)?g(I,!1):g(C)})}e.reset(a),e.template_effect(()=>s=e.set_class(a,1,"recording-overlay svelte-1qn0337",null,s,{"has-audio":e.get(X)!==null})),e.append(t,a)};e.if(ze,t=>{e.get(i),e.deep_read_state(k()),e.untrack(()=>e.get(i)&&e.get(i).includes("microphone")&&k()==="microphone")&&t(tt)})}var Re=e.sibling(ze,2);{var rt=t=>{e.bind_this(It(t,{onload:Ye,get file_count(){return b()},get filetype(){return e.get(v)},get root(){return re()},get max_file_size(){return m()},show_progress:!1,disable_click:!0,onerror:a=>M("error",a),hidden:!0,get upload(){return y()},get stream_handler(){return D()},get upload_promise(){return Q()},set upload_promise(a){Q(a)},get dragging(){return Y()},set dragging(a){Y(a)},get uploading(){return e.get(Z)},set uploading(a){e.set(Z,a)},$$legacy:!0}),a=>e.set(G,a),()=>e.get(G))};e.if(Re,t=>{e.get(F)&&t(rt)})}var pe=e.sibling(Re,2);let De;var Se=e.child(pe);{var at=t=>{var a=$t(),s=e.child(a);{var c=p=>{var _=Ot(),ee=e.child(_);Be(ee),e.reset(_),e.template_effect(()=>_.disabled=h()),e.event("click",_,ke),e.append(p,_)};e.if(s,p=>{e.get(F)&&p(c)})}var C=e.sibling(s,2);e.each(C,1,()=>(e.deep_read_state(r()),e.untrack(()=>r().files)),e.index,(p,_,ee)=>{var W=Qt(),oe=e.child(W),ae=e.child(oe);{var ge=te=>{Tt(te,{get src(){return e.get(_),e.untrack(()=>e.get(_).url)},restProps:{title:null,alt:"",loading:"lazy",class:"thumbnail-image"}})},me=te=>{var Fe=e.comment(),ct=e.first_child(Fe);{var _t=le=>{Dt(le)},pt=le=>{var He=e.comment(),ft=e.first_child(He);{var gt=se=>{St(se)},mt=se=>{Mt(se)};e.if(ft,se=>{e.get(_),e.untrack(()=>e.get(_).mime_type&&e.get(_).mime_type.includes("video"))?se(gt):se(mt,!1)},!0)}e.append(le,He)};e.if(ct,le=>{e.get(_),e.untrack(()=>e.get(_).mime_type&&e.get(_).mime_type.includes("audio"))?le(_t):le(pt,!1)},!0)}e.append(te,Fe)};e.if(ae,te=>{e.get(_),e.untrack(()=>e.get(_).mime_type&&e.get(_).mime_type.includes("image"))?te(ge):te(me,!1)})}var ve=e.sibling(ae,2),ut=e.child(ve);Ue(ut),e.reset(ve),e.reset(oe),e.reset(W),e.event("click",ve,te=>Xe(te,ee)),e.append(p,W)});var I=e.sibling(C,2);{var g=p=>{var _=Zt();e.append(p,_)};e.if(I,p=>{e.get(Z)&&p(g)})}e.reset(a),e.append(t,a)};e.if(Se,t=>{e.deep_read_state(r()),e.get(Z),e.untrack(()=>r().files.length>0||e.get(Z))&&t(at)})}var Me=e.sibling(Se,2),Ee=e.child(Me);{var lt=t=>{var a=er(),s=e.child(a);Be(s),e.reset(a),e.template_effect(()=>a.disabled=h()),e.event("click",a,ke),e.append(t,a)};e.if(Ee,t=>{e.get(F),e.deep_read_state(r()),e.get(Z),e.untrack(()=>e.get(F)&&r().files.length===0&&!e.get(Z))&&t(lt)})}var fe=e.sibling(Ee,2),o=e.child(fe);e.remove_textarea_child(o);let Ie;e.action(o,(t,a)=>Wt?.(t,a),()=>({text:r().text,lines:u(),max_lines:z()})),e.effect(()=>e.bind_value(o,()=>r().text,t=>r(r().text=t,!0))),e.bind_this(o,t=>e.set(x,t),()=>e.get(x)),e.effect(()=>e.event("keypress",o,Ve)),e.effect(()=>e.event("blur",o,function(t){e.bubble_event.call(this,l,t)})),e.effect(()=>e.event("select",o,Le)),e.effect(()=>e.event("focus",o,function(t){e.bubble_event.call(this,l,t)})),e.effect(()=>e.event("scroll",o,Ke)),e.effect(()=>e.event("paste",o,Oe));var st=e.sibling(o,2);Ct(st,{get visible(){return e.get(xe)},position:"absolute"}),e.reset(fe);var Te=e.sibling(fe,2);{var ot=t=>{var a=tr();let s;var c=e.child(a);At(c),e.reset(a),e.template_effect(()=>{s=e.set_class(a,1,"microphone-button svelte-1qn0337",null,s,{recording:e.get($)}),a.disabled=h()}),e.event("click",a,async()=>{k()!=="microphone"?(k("microphone"),await N(),e.set($,!0)):(k(null),e.set($,!1))}),e.append(t,a)};e.if(Te,t=>{e.get(i),e.untrack(()=>e.get(i)&&e.get(i).includes("microphone"))&&t(ot)})}var Pe=e.sibling(Te,2);{var it=t=>{var a=rr();let s;var c=e.child(a);{var C=g=>{Rt(g)},I=g=>{var p=e.text();e.template_effect(()=>e.set_text(p,P())),e.append(g,p)};e.if(c,g=>{P()===!0?g(C):g(I,!1)})}e.reset(a),e.template_effect(()=>{s=e.set_class(a,1,"submit-button svelte-1qn0337",null,s,{"padded-button":P()!==!0}),a.disabled=h()}),e.event("click",a,Ne),e.append(t,a)};e.if(Pe,t=>{P()&&t(it)})}var nt=e.sibling(Pe,2);{var dt=t=>{var a=ar();let s;var c=e.child(a);{var C=g=>{Ge(g,{fill:"none",stroke_width:2.5})},I=g=>{var p=e.text();e.template_effect(()=>e.set_text(p,L())),e.append(g,p)};e.if(c,g=>{L()===!0?g(C):g(I,!1)})}e.reset(a),e.template_effect(()=>s=e.set_class(a,1,"stop-button svelte-1qn0337",null,s,{"padded-button":L()!==!0})),e.event("click",a,Je),e.append(t,a)};e.if(nt,t=>{L()&&t(dt)})}return e.reset(Me),e.reset(pe),e.reset(Ae),e.reset(J),e.bind_this(J,t=>e.set(ce,t),()=>e.get(ce)),e.template_effect(()=>{qe=e.set_class(J,1,"full-container svelte-1qn0337",null,qe,{dragging:Y()}),De=e.set_class(pe,1,"input-wrapper svelte-1qn0337",null,De,{"has-files":r().files.length>0||e.get(Z)}),e.set_attribute(o,"dir",V()?"rtl":"ltr"),e.set_attribute(o,"placeholder",q()),e.set_attribute(o,"rows",u()),o.disabled=h(),e.set_style(o,U()?"text-align: "+U():""),e.set_attribute(o,"autocapitalize",(e.deep_read_state(d()),e.untrack(()=>d()?.autocapitalize))),e.set_attribute(o,"autocorrect",(e.deep_read_state(d()),e.untrack(()=>d()?.autocorrect))),e.set_attribute(o,"spellcheck",(e.deep_read_state(d()),e.untrack(()=>d()?.spellcheck))),e.set_attribute(o,"autocomplete",(e.deep_read_state(d()),e.untrack(()=>d()?.autocomplete))),e.set_attribute(o,"tabindex",(e.deep_read_state(d()),e.untrack(()=>d()?.tabindex))),e.set_attribute(o,"enterkeyhint",(e.deep_read_state(d()),e.untrack(()=>d()?.enterkeyhint))),e.set_attribute(o,"lang",(e.deep_read_state(d()),e.untrack(()=>d()?.lang))),Ie=e.set_class(o,1,"svelte-1qn0337",null,Ie,{"no-label":!A()}),o.dir=o.dir}),e.event("dragenter",J,Qe),e.event("dragleave",J,Ze),e.event("dragover",J,e.preventDefault(function(t){e.bubble_event.call(this,l,t)})),e.event("drop",J,$e),e.append(w,J),e.pop(et)}var or=e.from_html("<!> <!>",1);function Gr(w,l){e.push(l,!0);let i=e.state(void 0);class v extends bt{async get_data(){return e.get(i)&&(await e.get(i),await N()),await super.get_data()}}let F=e.rest_props(l,["$$slots","$$events","$$legacy"]);const r=new v(F),T=e.derived(()=>r.props.value||{text:"",files:[]});let u=e.state(!1),f=e.state(null),q="darkorange";const h={height:50,barWidth:2,barGap:3,cursorWidth:2,cursorColor:"#ddd5e9",autoplay:!1,barRadius:10,dragToSeek:!0,normalize:!0,minPxPerSec:20,waveColor:"",progressColor:"",mediaControls:!1,sampleRate:44100};he(()=>{q=getComputedStyle(document?.documentElement).getPropertyValue("--color-accent"),j(),h.waveColor=r.props?.waveform_options?.waveform_color||"#9ca3af",h.progressColor=r.props?.waveform_options?.waveform_progress_color||q,h.mediaControls=r.props?.waveform_options?.show_controls,h.sampleRate=r.props?.waveform_options?.sample_rate||44100});const H={color:r.props?.waveform_options?.trim_region_color};function j(){document.documentElement.style.setProperty("--trim-region-color",H.color||q)}const A=(...R)=>r.shared.client.upload(...R),z=R=>r.i18n(R),P=(...R)=>r.shared.client.stream(...R);let L=e.derived(()=>r.props.sources.join(",")),V=e.derived(()=>(r.props.file_types||[]).join(",")||null);{let R=e.derived(()=>[...r.shared.elem_classes||[],"multimodal-textbox"]),U=e.derived(()=>e.get(u)?"focus":"base");Et(w,{get visible(){return r.shared.visible},get elem_id(){return r.shared.elem_id},get elem_classes(){return e.get(R)},get scale(){return r.shared.scale},get min_width(){return r.shared.min_width},allow_overflow:!1,padding:!1,get border_mode(){return e.get(U)},get rtl(){return r.props.rtl},children:(O,re)=>{var K=or(),m=e.first_child(K);{var y=b=>{Bt(b,e.spread_props({get autoscroll(){return r.shared.autoscroll},get i18n(){return r.i18n}},()=>r.shared.loading_status,{on_clear_status:()=>r.dispatch("clear_status",r.shared.loading_status)}))};e.if(m,b=>{r.shared.loading_status&&b(y)})}var D=e.sibling(m,2);{let b=e.derived(()=>r.shared.label||"MultimodalTextbox"),B=e.derived(()=>r.props.max_lines?r.props.max_lines:r.props.lines+1),S=e.derived(()=>!r.shared.interactive);sr(D,{get value(){return e.get(T)},value_is_output:!0,get file_types_string(){return e.get(V)},get root(){return r.shared.root},get label(){return e.get(b)},get info(){return r.props.info},get show_label(){return r.shared.show_label},get lines(){return r.props.lines},get rtl(){return r.props.rtl},get text_align(){return r.props.text_align},get waveform_settings(){return h},i18n:z,get max_lines(){return e.get(B)},get placeholder(){return r.props.placeholder},get submit_btn(){return r.props.submit_btn},get stop_btn(){return r.props.stop_btn},get autofocus(){return r.props.autofocus},get autoscroll(){return r.shared.autoscroll},get file_count(){return r.props.file_count},get sources_string(){return e.get(L)},get max_file_size(){return r.shared.max_file_size},get disabled(){return e.get(S)},upload:A,stream_handler:P,get max_plain_text_length(){return r.props.max_plain_text_length},get html_attributes(){return r.props.html_attributes},get upload_promise(){return e.get(i)},set upload_promise(n){e.set(i,n,!0)},get dragging(){return e.get(u)},set dragging(n){e.set(u,n,!0)},get active_source(){return e.get(f)},set active_source(n){e.set(f,n,!0)},$$events:{change:n=>(r.props.value=n.detail,r.dispatch("change",r.props.value)),input:()=>r.dispatch("input"),submit:()=>r.dispatch("submit"),stop:()=>r.dispatch("stop"),blur:()=>r.dispatch("blur"),select:n=>r.dispatch("select",n.detail),focus:()=>r.dispatch("focus"),error:({detail:n})=>{r.dispatch("error",n)},start_recording:()=>r.dispatch("start_recording"),pause_recording:()=>r.dispatch("pause_recording"),stop_recording:()=>r.dispatch("stop_recording"),upload:n=>r.dispatch("upload",n.detail),clear:()=>r.dispatch("clear")}})}e.append(O,K)},$$slots:{default:!0}})}e.pop()}export{Vr as BaseExample,sr as BaseMultimodalTextbox,Gr as default};
