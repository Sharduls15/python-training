import"./svelte/svelte_internal_flags_async.js";import*as e from"./svelte/svelte_internal_client.js";import"./i18n-BSEU4Bba.js";import{G as ue}from"./utils.svelte-kG009vb9.js";import{g as le,e as re,R as te,K as se,B as de}from"./ScrollFade-Df4eOX7N.js";import"./svelte/svelte_internal_flags_legacy.js";import{tick as ce}from"./svelte/svelte_svelte.js";import{fly as _e}from"./svelte/svelte_transition.js";import{S as pe}from"./StreamingBar-Ck4VV0Q5.js";import{default as et}from"./Example-BY9hq5K4.js";import"./svelte/svelte_store.js";import"./index-Iu0hi-Ff.js";import"./svelte/svelte_animate.js";import"./svelte/svelte_attachments.js";import"./svelte/svelte_easing.js";import"./svelte/svelte_internal_flags_tracing.js";import"./svelte/svelte_internal_server.js";import"./svelte/svelte_legacy.js";import"./svelte/svelte_motion.js";import"./svelte/svelte_reactivity.js";import"./svelte/svelte_reactivity_window.js";import"./svelte/svelte_server.js";import"./svelte/svelte_events.js";import"./MarkdownCode-B3eIh5Gl.js";import"./prism-python-BCCznRiZ.js";var ve=e.from_html('<li data-testid="dropdown-option" role="option"><span>âœ“</span> </li>'),fe=e.from_html('<ul class="options svelte-1ou0lab" role="listbox"></ul>'),ge=e.from_html('<div class="reference"></div> <!>',1);function ne(f,r){e.push(r,!0);let t=e.prop(r,"show_options",3,!1),s=e.prop(r,"disabled",3,!1),i=e.prop(r,"selected_indices",19,()=>[]),u=e.prop(r,"active_index",3,null),g=e.prop(r,"remember_scroll",3,!1),G=e.prop(r,"offset_from_top",3,0),S=e.prop(r,"from_top",3,!1),T,p,C,v=e.state(0),z,d,A=e.state(null),o=e.state(null),I=e.state(0),U=e.state(0),H=0;function _(){const{top:h,bottom:m}=z.getBoundingClientRect();S()?T=G():T=h,p=e.get(U)-m}let c=null;function q(){t()&&(c!==null&&clearTimeout(c),c=setTimeout(()=>{_(),c=null},10))}function Z(){d?.scrollTo?.(0,H)}e.user_effect(()=>{if(t()&&z){if(g())Z();else if(d&&i().length>0){let m=d.querySelectorAll("li");for(const L of Array.from(m))if(L.getAttribute("data-index")===i()[0].toString()){d?.scrollTo?.(0,L.offsetTop);break}}_();const h=z.parentElement?.getBoundingClientRect();C=h?.height||0,e.set(v,h?.width||0,!0),r.onload?.()}p>T||S()?(e.set(A,`${T}px`),e.set(I,p,!0),e.set(o,null)):(e.set(o,`${p+C}px`),e.set(I,T-C),e.set(A,null))});var K=ge();e.event("scroll",e.window,q);var M=e.first_child(K);e.bind_this(M,h=>z=h,()=>z);var B=e.sibling(M,2);{var W=h=>{var m=fe();m.__mousedown=R=>{R.preventDefault(),r.onchange?.(R.target.dataset.index)};let L;e.each(m,21,()=>r.filtered_indices,e.index,(R,b)=>{var D=ve();let j,Q;var F=e.child(D);let w;var N=e.sibling(F);e.reset(D),e.template_effect((X,Y,y)=>{j=e.set_class(D,1,"item svelte-1ou0lab",null,j,X),e.set_attribute(D,"data-index",e.get(b)),e.set_attribute(D,"aria-label",r.choices[e.get(b)][0]),e.set_attribute(D,"aria-selected",Y),Q=e.set_style(D,"",Q,{width:e.get(v)+"px"}),w=e.set_class(F,1,"inner-item svelte-1ou0lab",null,w,y),e.set_text(N,` ${r.choices[e.get(b)][0]??""}`)},[()=>({selected:i().includes(e.get(b)),active:e.get(b)===u(),"bg-gray-100":e.get(b)===u(),"dark:bg-gray-600":e.get(b)===u()}),()=>i().includes(e.get(b)),()=>({hide:!i().includes(e.get(b))})]),e.append(R,D)}),e.reset(m),e.bind_this(m,R=>d=R,()=>d),e.template_effect(()=>L=e.set_style(m,"",L,{top:e.get(A),bottom:e.get(o),"max-height":`calc(${e.get(I)}px - var(--window-padding))`,width:e.get(v)+"px"})),e.event("scroll",m,R=>H=R.currentTarget.scrollTop),e.transition(3,m,()=>_e,()=>({duration:200,y:5})),e.append(h,m)};e.if(B,h=>{t()&&!s()&&h(W)})}e.bind_window_size("innerHeight",h=>e.set(U,h,!0)),e.append(f,K),e.pop()}e.delegate(["mousedown"]);function he(f,r){return(f%r+r)%r}function ae(f,r){return f.reduce((t,s,i)=>((!r||s[0].toLowerCase().includes(r.toLowerCase()))&&t.push(i),t),[])}function oe(f,r,t){if(f.key==="Escape")return[!1,r];if((f.key==="ArrowDown"||f.key==="ArrowUp")&&t.length>0)if(r===null)r=f.key==="ArrowDown"?t[0]:t[t.length-1];else{const s=t.indexOf(r),i=f.key==="ArrowUp"?-1:1;r=t[he(s+i,t.length)]}return[!0,r]}var me=e.from_html('<div class="token-remove svelte-1dv2vbb" role="button" tabindex="0"><!></div>'),be=e.from_html('<div class="token svelte-1dv2vbb"><span class="svelte-1dv2vbb"><!></span> <!></div>'),we=e.from_html('<div role="button" tabindex="0" class="token-remove remove-all svelte-1dv2vbb"><!></div>'),ye=e.from_html('<!> <span class="icon-wrap svelte-1dv2vbb"><!></span>',1),ke=e.from_html('<div><!> <!> <div class="wrap svelte-1dv2vbb"><div><!> <div class="secondary-wrap svelte-1dv2vbb"><input autocomplete="off"/> <!></div></div> <!></div></div>');function xe(f,r){e.push(r,!0),e.rest_props(r,["$$slots","$$events","$$legacy"]);const t=r.gradio;let s,i=e.state(""),u=e.derived(()=>t.shared.label||"Multiselect"),g=e.derived(()=>t.props.buttons),G=e.derived(()=>t.props.choices.map(l=>l[0])),S=e.derived(()=>t.props.choices.map(l=>l[1])),T=e.derived(()=>!t.shared.interactive),p=e.state(!1),C=e.derived(()=>{const l=ae(t.props.choices,e.get(i));return[l,l.length>0&&!t.props.allow_custom_value?l[0]:null]}),v=e.derived(()=>e.to_array(e.get(C),2)),z=e.derived(()=>e.get(v)[0]),d=e.derived(()=>e.get(v)[1]);function A(){return t.props.value===void 0?[]:Array.isArray(t.props.value)?t.props.value.map(l=>{const a=e.get(S).indexOf(l);if(a!==-1)return a;if(t.props.allow_custom_value)return l}).filter(l=>l!==void 0):[]}let o=e.derived(A);function I(){t.props.allow_custom_value||e.set(i,""),t.props.allow_custom_value&&e.get(i)!==""&&(H(e.get(i)),e.set(i,"")),t.dispatch("blur"),e.set(p,!1),e.set(d,null)}function U(l){e.set(o,e.get(o).filter(a=>a!==l)),t.props.value=e.get(o).map(a=>typeof a=="number"?e.get(S)[a]:a),t.dispatch("input"),t.dispatch("select",{index:typeof l=="number"?l:-1,value:typeof l=="number"?e.get(S)[l]:l,selected:!1})}function H(l){(t.props.max_choices==null||e.get(o).length<t.props.max_choices)&&(e.get(o).push(l),t.dispatch("select",{index:typeof l=="number"?l:-1,value:typeof l=="number"?e.get(S)[l]:l,selected:!0})),e.get(o).length===t.props.max_choices&&(e.set(p,!1),e.set(d,null),s.blur()),t.props.value=e.get(o).map(a=>typeof a=="number"?e.get(S)[a]:a)}function _(l){const a=parseInt(l);c(a)}function c(l){e.get(o).includes(l)?U(l):H(l),e.set(i,""),e.set(d,null),t.dispatch("input")}function q(l){e.set(o,[]),e.set(i,""),t.props.value=[],l.preventDefault()}function Z(l){e.set(z,t.props.choices.map((a,O)=>O)),(t.props.max_choices===null||e.get(o).length<t.props.max_choices)&&e.set(p,!0),t.dispatch("focus"),e.set(p,!0)}function K(l){(a=>{var O=e.to_array(a,2);e.set(p,O[0],!0),e.set(d,O[1])})(oe(l,e.get(d),e.get(z))),l.key==="Enter"&&(e.get(d)!==null?c(e.get(d)):t.props.allow_custom_value&&(H(e.get(i)),e.set(i,""))),l.key==="Backspace"&&e.get(i)===""&&e.set(o,[...e.get(o).slice(0,-1)]),e.get(o).length===t.props.max_choices&&(e.set(p,!1),e.set(d,null))}let M=e.state(e.proxy(t.props.value));e.user_effect(()=>{e.get(M)!==t.props.value&&(e.set(M,t.props.value,!0),t.dispatch("change"))});function B(l){t.dispatch("custom_button_click",{id:l})}var W=ke();let h;var m=e.child(W);{var L=l=>{re(l,{get buttons(){return e.get(g)},on_custom_button_click:B})};e.if(m,l=>{t.shared.show_label&&e.get(g)&&e.get(g).length>0&&l(L)})}var R=e.sibling(m,2);le(R,{get show_label(){return t.shared.show_label},get info(){return t.props.info},children:(l,a)=>{e.next();var O=e.text();e.template_effect(()=>e.set_text(O,e.get(u))),e.append(l,O)},$$slots:{default:!0}});var b=e.sibling(R,2),D=e.child(b);let j;var Q=e.child(D);e.each(Q,17,()=>e.get(o),e.index,(l,a)=>{var O=be(),V=e.child(O),n=e.child(V);{var k=E=>{var P=e.text();e.template_effect(()=>e.set_text(P,e.get(G)[e.get(a)])),e.append(E,P)},x=E=>{var P=e.text();e.template_effect(()=>e.set_text(P,e.get(a))),e.append(E,P)};e.if(n,E=>{typeof e.get(a)=="number"?E(k):E(x,!1)})}e.reset(V);var J=e.sibling(V,2);{var $=E=>{var P=me(),ie=e.child(P);te(ie),e.reset(P),e.template_effect(ee=>e.set_attribute(P,"title",ee),[()=>t.i18n("common.remove")+" "+e.get(a)]),e.event("click",P,e.preventDefault(()=>U(e.get(a)))),e.event("keydown",P,ee=>{ee.key==="Enter"&&U(e.get(a))}),e.append(E,P)};e.if(J,E=>{e.get(T)||E($)})}e.reset(O),e.append(l,O)});var F=e.sibling(Q,2),w=e.child(F);e.remove_input_defaults(w);let N;e.bind_this(w,l=>s=l,()=>s);var X=e.sibling(w,2);{var Y=l=>{var a=ye(),O=e.first_child(a);{var V=x=>{var J=we(),$=e.child(J);te($),e.reset(J),e.template_effect(E=>e.set_attribute(J,"title",E),[()=>t.i18n("common.clear")]),e.event("click",J,q),e.event("keydown",J,E=>{E.key==="Enter"&&q(E)}),e.append(x,J)};e.if(O,x=>{e.get(o).length>0&&x(V)})}var n=e.sibling(O,2),k=e.child(n);se(k),e.reset(n),e.append(l,a)};e.if(X,l=>{e.get(T)||l(Y)})}e.reset(F),e.reset(D);var y=e.sibling(D,2);ne(y,{get show_options(){return e.get(p)},get choices(){return t.props.choices},get filtered_indices(){return e.get(z)},get disabled(){return e.get(T)},get selected_indices(){return e.get(o)},get active_index(){return e.get(d)},remember_scroll:!0,onchange:_}),e.reset(b),e.reset(W),e.template_effect(l=>{h=e.set_class(W,1,"svelte-1dv2vbb",null,h,{container:t.shared.container}),j=e.set_class(D,1,"wrap-inner svelte-1dv2vbb",null,j,{show_options:e.get(p)}),N=e.set_class(w,1,"border-none svelte-1dv2vbb",null,N,l),w.disabled=e.get(T),w.readOnly=!t.props.filterable},[()=>({subdued:!e.get(G).includes(e.get(i))&&!t.props.allow_custom_value||e.get(o).length===t.props.max_choices})]),e.bind_value(w,()=>e.get(i),l=>e.set(i,l)),e.event("keydown",w,K),e.event("keyup",w,l=>{t.dispatch("key_up",{key:l.key,input_value:e.get(i)})}),e.event("blur",w,I),e.event("focus",w,Z),e.append(f,W),e.pop()}var Ae=e.from_html('<div class="icon-wrap svelte-1xfsv4t"><!></div>'),Be=e.from_html('<div><!> <!> <div class="wrap svelte-1xfsv4t"><div><div class="secondary-wrap svelte-1xfsv4t"><input role="listbox" aria-controls="dropdown-options" autocomplete="off"/> <!></div></div> <!></div></div>');function De(f,r){e.push(r,!0);const t=typeof window<"u";let s=e.prop(r,"label",3,"Dropdown"),i=e.prop(r,"info",3,void 0),u=e.prop(r,"value",15),g=e.prop(r,"choices",19,()=>[]),G=e.prop(r,"interactive",3,!0),S=e.prop(r,"show_label",3,!0),T=e.prop(r,"container",3,!0),p=e.prop(r,"allow_custom_value",3,!1),C=e.prop(r,"filterable",3,!0),v=e.prop(r,"buttons",3,null),z=e.prop(r,"oncustom_button_click",3,null),d,A=e.derived(()=>t&&d===document.activeElement),o=e.derived(()=>g().map(n=>n[0])),I=e.derived(()=>g().map(n=>n[1])),U=e.derived(()=>u()===void 0||u()===null||Array.isArray(u())&&u().length===0?["",null]:e.get(I).includes(u())?[e.get(o)[e.get(I).indexOf(u())],e.get(I).indexOf(u())]:p()?[u(),null]:["",null]),H=e.derived(()=>e.to_array(e.get(U),2)),_=e.derived(()=>e.get(H)[0]),c=e.derived(()=>e.get(H)[1]),q=e.get(_),Z=e.state(!1),K=e.derived(()=>!G()),M=e.state(e.proxy(g().map((n,k)=>k))),B=e.state(null);function W(n){if(e.set(c,parseInt(n)),isNaN(e.get(c))){e.set(c,null);return}let[k,x]=g()[e.get(c)];e.set(_,k),q=e.get(_),u(x),r.on_select?.({index:e.get(c),value:e.get(I)[e.get(c)],selected:!0}),e.set(A,!1),e.set(B,null),r.on_input?.(),d.blur()}function h(n){e.set(M,g().map((k,x)=>x),!0),e.set(A,!0),r.on_focus?.()}function m(){p()?e.get(o).includes(e.get(_))?(e.set(c,e.get(o).indexOf(e.get(_))),u(e.get(I)[e.get(c)])):e.get(_)!==q&&(u(e.get(_)),e.set(c,null)):e.set(_,e.get(o)[e.get(I).indexOf(u())]),e.set(A,!1),e.set(B,null),e.set(M,g().map((n,k)=>k),!0),r.on_blur?.(),r.on_input?.()}async function L(n){await ce(),e.set(M,ae(g(),e.get(_)),!0),e.set(B,e.get(M).length>0?e.get(M)[0]:null,!0),(k=>{var x=e.to_array(k,2);e.set(A,x[0]),e.set(B,x[1],!0)})(oe(n,e.get(B),e.get(M))),n.key==="Enter"&&(q=e.get(_),e.get(B)!==null?(e.set(c,e.get(B)),u(e.get(I)[e.get(B)]),e.set(A,!1),d.blur(),e.set(B,null)):e.get(o).includes(e.get(_))?(e.set(c,e.get(o).indexOf(e.get(_))),u(e.get(I)[e.get(c)]),e.set(A,!1),e.set(B,null),d.blur()):p()&&(u(e.get(_)),e.set(c,null),e.set(A,!1),e.set(B,null),d.blur()))}let R=e.state(e.proxy(u()));e.user_effect(()=>{e.get(R)!==u()&&(e.set(R,u(),!0),r.on_change?.(u()))});var b=Be();let D;var j=e.child(b);{var Q=n=>{re(n,{get buttons(){return v()},get on_custom_button_click(){return z()}})};e.if(j,n=>{S()&&v()&&v().length>0&&n(Q)})}var F=e.sibling(j,2);le(F,{get show_label(){return S()},get info(){return i()},children:(n,k)=>{e.next();var x=e.text();e.template_effect(()=>e.set_text(x,s())),e.append(n,x)},$$slots:{default:!0}});var w=e.sibling(F,2),N=e.child(w);let X;var Y=e.child(N),y=e.child(Y);e.remove_input_defaults(y);let l;y.__keydown=L,y.__keyup=n=>{r.on_key_up?.({key:n.key,input_value:e.get(_)})},e.bind_this(y,n=>d=n,()=>d);var a=e.sibling(y,2);{var O=n=>{var k=Ae(),x=e.child(k);se(x),e.reset(k),e.append(n,k)};e.if(a,n=>{e.get(K)||n(O)})}e.reset(Y),e.reset(N);var V=e.sibling(N,2);{let n=e.derived(()=>e.get(c)===null?[]:[e.get(c)]);ne(V,{get show_options(){return e.get(A)},get choices(){return g()},get filtered_indices(){return e.get(M)},get disabled(){return e.get(K)},get selected_indices(){return e.get(n)},get active_index(){return e.get(B)},onchange:W,onload:()=>e.set(Z,!0)})}e.reset(w),e.reset(b),e.template_effect(n=>{D=e.set_class(b,1,"svelte-1xfsv4t",null,D,{container:T()}),X=e.set_class(N,1,"wrap-inner svelte-1xfsv4t",null,X,{show_options:e.get(A)}),e.set_attribute(y,"aria-expanded",e.get(A)),e.set_attribute(y,"aria-label",s()),l=e.set_class(y,1,"border-none svelte-1xfsv4t",null,l,n),y.disabled=e.get(K),y.readOnly=!C()},[()=>({subdued:!e.get(o).includes(e.get(_))&&!p()})]),e.event("blur",y,m),e.event("focus",y,h),e.bind_value(y,()=>e.get(_),n=>e.set(_,n)),e.append(f,b),e.pop()}e.delegate(["keydown","keyup"]);var Oe=e.from_html("<!> <!>",1);function Ye(f,r){e.push(r,!0);let t=e.rest_props(r,["$$slots","$$events","$$legacy"]);const s=new ue(t);de(f,{get visible(){return s.shared.visible},get elem_id(){return s.shared.elem_id},get elem_classes(){return s.shared.elem_classes},get padding(){return s.shared.container},allow_overflow:!1,get scale(){return s.shared.scale},get min_width(){return s.shared.min_width},children:(i,u)=>{var g=Oe(),G=e.first_child(g);pe(G,e.spread_props({get autoscroll(){return s.shared.autoscroll},get i18n(){return s.i18n}},()=>s.shared.loading_status,{on_clear_status:()=>s.dispatch("clear_status",loading_status)}));var S=e.sibling(G,2);{var T=C=>{xe(C,{get gradio(){return s}})},p=C=>{De(C,{get label(){return s.shared.label},get info(){return s.props.info},get choices(){return s.props.choices},get interactive(){return s.shared.interactive},get show_label(){return s.shared.show_label},get container(){return s.shared.container},get allow_custom_value(){return s.props.allow_custom_value},get filterable(){return s.props.filterable},get buttons(){return s.props.buttons},oncustom_button_click:v=>{s.dispatch("custom_button_click",{id:v})},on_change:()=>s.dispatch("change"),on_input:()=>s.dispatch("input"),on_select:v=>s.dispatch("select",v),on_focus:()=>s.dispatch("focus"),on_blur:()=>s.dispatch("blur"),on_key_up:v=>s.dispatch("key_up",v),get value(){return s.props.value},set value(v){s.props.value=v}})};e.if(S,C=>{s.props.multiselect?C(T):C(p,!1)})}e.append(i,g)},$$slots:{default:!0}}),e.pop()}export{De as BaseDropdown,ne as BaseDropdownOptions,et as BaseExample,xe as BaseMultiselect,Ye as default};
